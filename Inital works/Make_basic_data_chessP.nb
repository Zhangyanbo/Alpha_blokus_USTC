(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     46640,       1286]
NotebookOptionsPosition[     44353,       1202]
NotebookOutlinePosition[     44710,       1218]
CellTagsIndexPosition[     44667,       1215]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\:83b7\:53d6\:5377\:79ef\:6838", "Section"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetChesses", "[", "core_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"nears", ",", "corner"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nears", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ListConvolve", "[", 
          RowBox[{
           RowBox[{"(", "\[NoBreak]", GridBox[{
              {"0", "1", "0"},
              {"1", "0", "1"},
              {"0", "1", "0"}
             }], "\[NoBreak]", ")"}], ",", 
           RowBox[{"ArrayPad", "[", 
            RowBox[{"core", ",", "1", ",", "0"}], "]"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", "core"}], ")"}]}], ")"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"n_", "/;", 
          RowBox[{"n", ">", "0"}]}], "\[Rule]", "1"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"corner", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "core"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", "nears"}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{"ListConvolve", "[", 
         RowBox[{
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"1", "0", "1"},
             {"0", "0", "0"},
             {"1", "0", "1"}
            }], "\[NoBreak]", ")"}], ",", 
          RowBox[{"ArrayPad", "[", 
           RowBox[{"core", ",", "1", ",", "0"}], "]"}]}], "]"}], ")"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"core", ",", "nears", ",", "corner"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"GetChesses", "[", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0", "0", "0", "0", "0", "0", "0"},
      {"0", "0", "0", "0", "0", "0", "0"},
      {"0", "0", "1", "0", "0", "0", "0"},
      {"0", "0", "1", "1", "0", "0", "0"},
      {"0", "0", "0", "1", "0", "0", "0"},
      {"0", "0", "0", "0", "0", "0", "0"},
      {"0", "0", "0", "0", "0", "0", "0"}
     }], "\[NoBreak]", ")"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "1", "0", "0", "0", "0"},
       {"0", "0", "1", "1", "0", "0", "0"},
       {"0", "0", "0", "1", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "1", "0", "0", "0", "0"},
       {"0", "1", "0", "1", "0", "0", "0"},
       {"0", "1", "0", "0", "1", "0", "0"},
       {"0", "0", "1", "0", "1", "0", "0"},
       {"0", "0", "0", "1", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0", "0", "0", "0"},
       {"0", "1", "0", "1", "0", "0", "0"},
       {"0", "0", "0", "0", "1", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0"},
       {"0", "1", "0", "0", "0", "0", "0"},
       {"0", "0", "1", "0", "1", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"GetChesses", "[", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0", "0", "0", "0", "0", "0", "0"},
      {"0", "0", "0", "0", "0", "0", "0"},
      {"0", "0", "0", "1", "0", "0", "0"},
      {"0", "0", "1", "1", "1", "0", "0"},
      {"0", "0", "0", "1", "0", "0", "0"},
      {"0", "0", "0", "0", "0", "0", "0"},
      {"0", "0", "0", "0", "0", "0", "0"}
     }], "\[NoBreak]", ")"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "1", "0", "0", "0"},
       {"0", "0", "1", "1", "1", "0", "0"},
       {"0", "0", "0", "1", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "1", "0", "0", "0"},
       {"0", "0", "1", "0", "1", "0", "0"},
       {"0", "1", "0", "0", "0", "1", "0"},
       {"0", "0", "1", "0", "1", "0", "0"},
       {"0", "0", "0", "1", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "1", "0", "1", "0", "0"},
       {"0", "1", "0", "0", "0", "1", "0"},
       {"0", "0", "0", "0", "0", "0", "0"},
       {"0", "1", "0", "0", "0", "1", "0"},
       {"0", "0", "1", "0", "1", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Output"]
}, Open  ]],

Cell[" ", "Text",
 Editable->False,
 Selectable->False,
 CellFrame->{{0, 0}, {0, 2}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellFrameColor->RGBColor[0, 0, 1],
 CellSize->{Inherited, 4}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\:53d8\:6362\:64cd\:4f5c", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RightRotate", "[", "m_", "]"}], ":=", 
  RowBox[{"Reverse", "/@", 
   RowBox[{"Transpose", "[", "m", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RightRotate", "[", 
   RowBox[{"m_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Nest", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Reverse", "/@", 
      RowBox[{"Transpose", "[", "#", "]"}]}], "&"}], ",", "m", ",", "n"}], 
   "]"}]}]}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LeftRotate", "[", "m_", "]"}], ":=", 
  RowBox[{"RightRotate", "[", 
   RowBox[{"m", ",", "3"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LeftRotate", "[", 
   RowBox[{"m_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"RightRotate", "[", 
   RowBox[{"m", ",", 
    RowBox[{"4", "-", "n"}]}], "]"}]}]}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Keep", "[", "m_", "]"}], ":=", "m"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Reflect", "[", "m_", "]"}], ":=", 
  RowBox[{"Reverse", "[", "m", "]"}]}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RightRotate", "[", 
   RowBox[{
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "1", "0", "0", "0", "0"},
       {"0", "0", "1", "1", "0", "0", "0"},
       {"0", "0", "0", "1", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0"}
      }], "\[NoBreak]", ")"}], ",", "4"}], "]"}], "//", 
  "MatrixForm"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "1", "1", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\:6392\:9664\:91cd\:590d", "Section"],

Cell[CellGroupData[{

Cell["\:7a77\:4e3e\:6240\:6709\:64cd\:4f5c\:ff1a", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetAllChesses", "[", "m_", "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"f2", "@", 
       RowBox[{"f1", "[", 
        RowBox[{
         RowBox[{"f0", "[", "m", "]"}], ",", "n"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"f0", ",", 
        RowBox[{"{", 
         RowBox[{"Keep", ",", "Reflect"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"f1", ",", 
        RowBox[{"{", "RightRotate", "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"f2", ",", 
        RowBox[{"{", 
         RowBox[{"Keep", ",", "Reflect"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", "3"}], 
   "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tally", "[", 
  RowBox[{"MatrixForm", "/@", 
   RowBox[{"GetAllChesses", "[", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "1", "0", "0", "0", "0"},
       {"0", "0", "1", "1", "0", "0", "0"},
       {"0", "0", "0", "1", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0"}
      }], "\[NoBreak]", ")"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0", "0", "0"},
         {"0", "0", "0", "1", "1", "0", "0"},
         {"0", "0", "1", "1", "0", "0", "0"},
         {"0", "0", "0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0", "0", "0"},
         {"0", "0", "0", "1", "0", "0", "0"},
         {"0", "0", "0", "1", "1", "0", "0"},
         {"0", "0", "0", "0", "1", "0", "0"},
         {"0", "0", "0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0", "0", "0"},
         {"0", "0", "0", "1", "1", "0", "0"},
         {"0", "0", "1", "1", "0", "0", "0"},
         {"0", "0", "0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0", "0", "0"},
         {"0", "0", "1", "0", "0", "0", "0"},
         {"0", "0", "1", "1", "0", "0", "0"},
         {"0", "0", "0", "1", "0", "0", "0"},
         {"0", "0", "0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0", "0", "0"},
         {"0", "0", "1", "1", "0", "0", "0"},
         {"0", "0", "0", "1", "1", "0", "0"},
         {"0", "0", "0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "1", "0", "0"},
         {"0", "0", "0", "1", "1", "0", "0"},
         {"0", "0", "0", "1", "0", "0", "0"},
         {"0", "0", "0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0", "0", "0"},
         {"0", "0", "1", "1", "0", "0", "0"},
         {"0", "0", "0", "1", "1", "0", "0"},
         {"0", "0", "0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0", "0", "0"},
         {"0", "0", "0", "1", "0", "0", "0"},
         {"0", "0", "1", "1", "0", "0", "0"},
         {"0", "0", "1", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", "2"}], "}"}]}], "}"}]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\:83b7\:53d6\:4e0d\:91cd\:590d\:68cb\:5b50", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TallyChesses", "[", "m_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Tally", "[", 
     RowBox[{"GetAllChesses", "[", "m", "]"}], "]"}], "\[Transpose]"}], 
   "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ArrayPlot", "/@", 
  RowBox[{"TallyChesses", "[", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0", "0", "0", "0", "0", "0", "0"},
      {"0", "0", "0", "0", "0", "0", "0"},
      {"0", "0", "0", "1", "0", "0", "0"},
      {"0", "0", "1", "1", "1", "0", "0"},
      {"0", "0", "0", "1", "0", "0", "0"},
      {"0", "0", "0", "0", "0", "0", "0"},
      {"0", "0", "0", "0", "0", "0", "0"}
     }], "\[NoBreak]", ")"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  GraphicsBox[
   RasterBox[{{1, 1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1, 1}, {1, 1, 1, 0, 1, 1,
     1}, {1, 1, 0, 0, 0, 1, 1}, {1, 1, 1, 0, 1, 1, 1}, {1, 1, 1, 1, 1, 1, 
    1}, {1, 1, 1, 1, 1, 1, 1}}, {{0, 0}, {7, 7}}, {0, 1}],
   Frame->Automatic,
   FrameLabel->{None, None},
   FrameTicks->{{None, None}, {None, None}},
   GridLinesStyle->Directive[
     GrayLevel[0.5, 0.4]],
   Method->{
    "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> Automatic}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ArrayPlot", "/@", 
  RowBox[{"TallyChesses", "[", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0", "0", "0", "0", "0", "0", "0"},
      {"0", "0", "0", "0", "0", "0", "0"},
      {"0", "0", "1", "0", "0", "0", "0"},
      {"0", "0", "1", "1", "0", "0", "0"},
      {"0", "0", "0", "1", "0", "0", "0"},
      {"0", "0", "0", "0", "0", "0", "0"},
      {"0", "0", "0", "0", "0", "0", "0"}
     }], "\[NoBreak]", ")"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   GraphicsBox[
    RasterBox[{{1, 1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 
     1, 1}, {1, 1, 0, 0, 1, 1, 1}, {1, 1, 1, 0, 0, 1, 1}, {1, 1, 1, 1, 1, 1, 
     1}, {1, 1, 1, 1, 1, 1, 1}}, {{0, 0}, {7, 7}}, {0, 1}],
    Frame->Automatic,
    FrameLabel->{None, None},
    FrameTicks->{{None, None}, {None, None}},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    Method->{
     "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> Automatic}], 
   ",", 
   GraphicsBox[
    RasterBox[{{1, 1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 0, 
     1, 1}, {1, 1, 1, 0, 0, 1, 1}, {1, 1, 1, 0, 1, 1, 1}, {1, 1, 1, 1, 1, 1, 
     1}, {1, 1, 1, 1, 1, 1, 1}}, {{0, 0}, {7, 7}}, {0, 1}],
    Frame->Automatic,
    FrameLabel->{None, None},
    FrameTicks->{{None, None}, {None, None}},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    Method->{
     "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> Automatic}], 
   ",", 
   GraphicsBox[
    RasterBox[{{1, 1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1, 1}, {1, 1, 0, 0, 1, 
     1, 1}, {1, 1, 1, 0, 0, 1, 1}, {1, 1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1, 
     1}, {1, 1, 1, 1, 1, 1, 1}}, {{0, 0}, {7, 7}}, {0, 1}],
    Frame->Automatic,
    FrameLabel->{None, None},
    FrameTicks->{{None, None}, {None, None}},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    Method->{
     "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> Automatic}], 
   ",", 
   GraphicsBox[
    RasterBox[{{1, 1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1, 1}, {1, 1, 1, 0, 1, 
     1, 1}, {1, 1, 0, 0, 1, 1, 1}, {1, 1, 0, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1, 
     1}, {1, 1, 1, 1, 1, 1, 1}}, {{0, 0}, {7, 7}}, {0, 1}],
    Frame->Automatic,
    FrameLabel->{None, None},
    FrameTicks->{{None, None}, {None, None}},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    Method->{
     "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> Automatic}], 
   ",", 
   GraphicsBox[
    RasterBox[{{1, 1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1, 1}, {1, 1, 1, 0, 0, 
     1, 1}, {1, 1, 0, 0, 1, 1, 1}, {1, 1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1, 
     1}, {1, 1, 1, 1, 1, 1, 1}}, {{0, 0}, {7, 7}}, {0, 1}],
    Frame->Automatic,
    FrameLabel->{None, None},
    FrameTicks->{{None, None}, {None, None}},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    Method->{
     "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> Automatic}], 
   ",", 
   GraphicsBox[
    RasterBox[{{1, 1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1, 1}, {1, 1, 1, 0, 1, 
     1, 1}, {1, 1, 1, 0, 0, 1, 1}, {1, 1, 1, 1, 0, 1, 1}, {1, 1, 1, 1, 1, 1, 
     1}, {1, 1, 1, 1, 1, 1, 1}}, {{0, 0}, {7, 7}}, {0, 1}],
    Frame->Automatic,
    FrameLabel->{None, None},
    FrameTicks->{{None, None}, {None, None}},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    Method->{
     "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> Automatic}], 
   ",", 
   GraphicsBox[
    RasterBox[{{1, 1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 
     1, 1}, {1, 1, 1, 0, 0, 1, 1}, {1, 1, 0, 0, 1, 1, 1}, {1, 1, 1, 1, 1, 1, 
     1}, {1, 1, 1, 1, 1, 1, 1}}, {{0, 0}, {7, 7}}, {0, 1}],
    Frame->Automatic,
    FrameLabel->{None, None},
    FrameTicks->{{None, None}, {None, None}},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    Method->{
     "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> Automatic}], 
   ",", 
   GraphicsBox[
    RasterBox[{{1, 1, 1, 1, 1, 1, 1}, {1, 1, 1, 1, 1, 1, 1}, {1, 1, 0, 1, 1, 
     1, 1}, {1, 1, 0, 0, 1, 1, 1}, {1, 1, 1, 0, 1, 1, 1}, {1, 1, 1, 1, 1, 1, 
     1}, {1, 1, 1, 1, 1, 1, 1}}, {{0, 0}, {7, 7}}, {0, 1}],
    Frame->Automatic,
    FrameLabel->{None, None},
    FrameTicks->{{None, None}, {None, None}},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    Method->{
     "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> Automatic}]}],
   "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "@", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"TallyChesses", "[", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "1", "0", "0", "0", "0"},
        {"0", "0", "1", "1", "0", "0", "0"},
        {"0", "0", "0", "1", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"}
       }], "\[NoBreak]", ")"}], "]"}], ",", "1"}], "]"}]}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "1", "0", "0"},
     {"0", "0", "1", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "1", "1", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "1", "0", "0"},
     {"0", "0", "1", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "1", "1", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "1", "0", "0", "0"},
     {"0", "0", "0", "1", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "1", "1", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "1", "0", "0", "0"},
     {"0", "0", "0", "1", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "1", "1", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\:5177\:4f53\:6570\:636e", "Section"],

Cell[BoxData[
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "1", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"}
       }], "\[NoBreak]", ")"}], ",", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "1", "1", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"}
       }], "\[NoBreak]", ")"}], ",", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "1", "0", "0", "0"},
        {"0", "0", "0", "1", "1", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"}
       }], "\[NoBreak]", ")"}], ",", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "1", "1", "0", "0", "0"},
        {"0", "0", "0", "1", "1", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"}
       }], "\[NoBreak]", ")"}], ",", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "1", "0", "0", "0"},
        {"0", "0", "0", "1", "0", "0", "0"},
        {"0", "0", "0", "1", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"}
       }], "\[NoBreak]", ")"}], ",", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "1", "1", "1", "0", "0", "0"},
        {"0", "0", "0", "1", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"}
       }], "\[NoBreak]", ")"}], ",", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "1", "0", "0", "0"},
        {"0", "0", "1", "1", "1", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"}
       }], "\[NoBreak]", ")"}], ",", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "1", "1", "1", "1", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"}
       }], "\[NoBreak]", ")"}], ",", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "1", "1", "0", "0"},
        {"0", "0", "0", "1", "1", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"}
       }], "\[NoBreak]", ")"}], ",", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "1", "1", "0", "0", "0"},
        {"0", "0", "0", "1", "1", "0", "0"},
        {"0", "0", "0", "0", "1", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"}
       }], "\[NoBreak]", ")"}], ",", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "1", "1", "0", "0"},
        {"0", "0", "0", "1", "1", "0", "0"},
        {"0", "0", "0", "1", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"}
       }], "\[NoBreak]", ")"}], ",", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "1", "0", "0", "0"},
        {"0", "0", "1", "1", "0", "0", "0"},
        {"0", "0", "0", "1", "1", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"}
       }], "\[NoBreak]", ")"}], ",", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "1", "1", "1", "1", "0"},
        {"0", "0", "1", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"}
       }], "\[NoBreak]", ")"}], ",", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "1", "0", "0", "0"},
        {"0", "0", "1", "1", "1", "0", "0"},
        {"0", "0", "0", "1", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"}
       }], "\[NoBreak]", ")"}], ",", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "1", "1", "1", "0"},
        {"0", "0", "0", "1", "0", "0", "0"},
        {"0", "0", "0", "1", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"}
       }], "\[NoBreak]", ")"}], ",", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "1", "0", "0", "0"},
        {"0", "0", "1", "1", "1", "1", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"}
       }], "\[NoBreak]", ")"}], ",", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "1", "0", "0", "0"},
        {"0", "0", "0", "1", "1", "1", "0"},
        {"0", "0", "0", "0", "0", "1", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"}
       }], "\[NoBreak]", ")"}], ",", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "1", "1", "1", "0", "0"},
        {"0", "0", "1", "0", "1", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"}
       }], "\[NoBreak]", ")"}], ",", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "1", "0", "0", "0"},
        {"0", "0", "0", "1", "1", "0", "0"},
        {"0", "0", "0", "0", "1", "0", "0"},
        {"0", "0", "0", "0", "1", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"}
       }], "\[NoBreak]", ")"}], ",", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "1", "0", "0", "0"},
        {"0", "0", "0", "1", "0", "0", "0"},
        {"0", "0", "1", "1", "1", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"}
       }], "\[NoBreak]", ")"}], ",", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", "0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "1", "0", "0", "0"},
        {"0", "0", "0", "1", "0", "0", "0"},
        {"0", "0", "0", "1", "0", "0", "0"},
        {"0", "0", "0", "1", "0", "0", "0"},
        {"0", "0", "0", "1", "0", "0", "0"},
        {"0", "0", "0", "0", "0", "0", "0"}
       }], "\[NoBreak]", ")"}]}], "}"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"transdata", "=", 
   RowBox[{"TallyChesses", "/@", "data"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pathx", "=", 
  RowBox[{
  "StringTemplate", "[", 
   "\"\<E:\\\\GitHub\\\\Alpha_blokus_USTC\\\\_data\\\\chesses\\\\`chessesID`\\\
\\`chessesRotate`\\\\`chessesType`.csv\>\"", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"TemplateObject", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\<\"E:\\\\GitHub\\\\Alpha_blokus_USTC\\\\_data\\\\chesses\\\\\"\>\
", ",", 
     RowBox[{"TemplateSlot", "[", "\<\"chessesID\"\>", "]"}], 
     ",", "\<\"\\\\\"\>", ",", 
     RowBox[{"TemplateSlot", "[", "\<\"chessesRotate\"\>", "]"}], 
     ",", "\<\"\\\\\"\>", ",", 
     RowBox[{"TemplateSlot", "[", "\<\"chessesType\"\>", "]"}], 
     ",", "\<\".csv\"\>"}], "}"}], ",", 
   RowBox[{"InsertionFunction", "\[Rule]", "TextString"}], ",", 
   RowBox[{"CombinerFunction", "\[Rule]", "StringJoin"}]}], "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dict", "=", 
  RowBox[{
  "StringTemplate", "[", 
   "\"\<E:\\\\GitHub\\\\Alpha_blokus_USTC\\\\_data\\\\chesses\\\\`chessesID`\\\
\\`chessesRotate`\>\"", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"TemplateObject", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\<\"E:\\\\GitHub\\\\Alpha_blokus_USTC\\\\_data\\\\chesses\\\\\"\>\
", ",", 
     RowBox[{"TemplateSlot", "[", "\<\"chessesID\"\>", "]"}], 
     ",", "\<\"\\\\\"\>", ",", 
     RowBox[{"TemplateSlot", "[", "\<\"chessesRotate\"\>", "]"}]}], "}"}], 
   ",", 
   RowBox[{"InsertionFunction", "\[Rule]", "TextString"}], ",", 
   RowBox[{"CombinerFunction", "\[Rule]", "StringJoin"}]}], "]"}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", "temp", "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\n", 
    RowBox[{
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"temp", "=", 
         RowBox[{"GetChesses", "[", 
          RowBox[{"transdata", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"CreateDirectory", "[", 
         RowBox[{"dict", "[", 
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\"\<chessesID\>\"", "\[Rule]", "i"}], ",", 
            RowBox[{"\"\<chessesRotate\>\"", "\[Rule]", "j"}]}], 
           "\[RightAssociation]"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"pathx", "[", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"\"\<chessesID\>\"", "\[Rule]", "i"}], ",", 
             RowBox[{"\"\<chessesRotate\>\"", "\[Rule]", "j"}], ",", 
             RowBox[{"\"\<chessesType\>\"", "\[Rule]", "\"\<O\>\""}]}], 
            "\[RightAssociation]"}], "]"}], ",", 
          RowBox[{
          "temp", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], ";", 
        RowBox[{"(*", "\:539f\:6570\:636e", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"pathx", "[", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"\"\<chessesID\>\"", "\[Rule]", "i"}], ",", 
             RowBox[{"\"\<chessesRotate\>\"", "\[Rule]", "j"}], ",", 
             RowBox[{"\"\<chessesType\>\"", "\[Rule]", "\"\<B\>\""}]}], 
            "\[RightAssociation]"}], "]"}], ",", 
          RowBox[{
          "temp", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         "]"}], ";", 
        RowBox[{"(*", "\:8fb9", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"pathx", "[", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"\"\<chessesID\>\"", "\[Rule]", "i"}], ",", 
             RowBox[{"\"\<chessesRotate\>\"", "\[Rule]", "j"}], ",", 
             RowBox[{"\"\<chessesType\>\"", "\[Rule]", "\"\<C\>\""}]}], 
            "\[RightAssociation]"}], "]"}], ",", 
          RowBox[{
          "temp", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
         "]"}]}], 
       RowBox[{"(*", "\:89d2", "*)"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{
          "transdata", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
           "]"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "transdata", "]"}]}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input"],

Cell[CellGroupData[{

Cell["\:751f\:6210\:76ee\:5f55", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
  "\"\<E:\\\\GitHub\\\\Alpha_blokus_USTC\\\\_data\\\\chesses\\\\TOC.txt\>\"", 
   ",", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"dict", "[", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"\"\<chessesID\>\"", "\[Rule]", "i"}], ",", 
           RowBox[{"\"\<chessesRotate\>\"", "\[Rule]", "j"}]}], 
          "\[RightAssociation]"}], "]"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{
           "transdata", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "transdata", "]"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], "]"}]], "Input"],

Cell[BoxData["\<\"E:\\\\GitHub\\\\Alpha_blokus_USTC\\\\_data\\\\chesses\\\\\
TOC.txt\"\>"], "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1920, 997},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"10.3 for Microsoft Windows (64-bit) (2015\:5e7410\:67089\
\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 49, 0, 70, "Section"],
Cell[632, 24, 1611, 47, 188, "Input"],
Cell[CellGroupData[{
Cell[2268, 75, 462, 11, 117, "Input"],
Cell[2733, 88, 2666, 68, 117, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5436, 161, 462, 11, 117, "Input"],
Cell[5901, 174, 2666, 68, 117, "Output"]
}, Open  ]],
Cell[8582, 245, 271, 9, 8, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8890, 259, 43, 0, 70, "Section"],
Cell[8936, 261, 435, 13, 52, "Input"],
Cell[9374, 276, 353, 10, 52, "Input"],
Cell[9730, 288, 204, 5, 52, "Input"],
Cell[CellGroupData[{
Cell[9959, 297, 499, 13, 117, "Input"],
Cell[10461, 312, 845, 22, 117, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[11355, 340, 43, 0, 70, "Section"],
Cell[CellGroupData[{
Cell[11423, 344, 64, 0, 49, "Subsection"],
Cell[11490, 346, 778, 24, 31, "Input"],
Cell[CellGroupData[{
Cell[12293, 374, 507, 12, 117, "Input"],
Cell[12803, 388, 7765, 194, 117, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[20617, 588, 64, 0, 49, "Subsection"],
Cell[20684, 590, 268, 7, 31, "Input"],
Cell[CellGroupData[{
Cell[20977, 601, 463, 11, 117, "Input"],
Cell[21443, 614, 518, 13, 197, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21998, 632, 463, 11, 117, "Input"],
Cell[22464, 645, 3972, 98, 197, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26473, 748, 541, 13, 117, "Input"],
Cell[27017, 763, 2903, 71, 852, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[29981, 841, 43, 0, 70, "Section"],
Cell[30027, 843, 8373, 193, 242, "Input"],
Cell[38403, 1038, 114, 3, 31, "Input"],
Cell[CellGroupData[{
Cell[38542, 1045, 218, 5, 31, "Input"],
Cell[38763, 1052, 606, 13, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39406, 1070, 196, 5, 31, "Input"],
Cell[39605, 1077, 486, 11, 31, "Output"]
}, Open  ]],
Cell[40106, 1091, 3001, 69, 244, "Input"],
Cell[CellGroupData[{
Cell[43132, 1164, 46, 0, 49, "Subsection"],
Cell[CellGroupData[{
Cell[43203, 1168, 1006, 26, 112, "Input"],
Cell[44212, 1196, 101, 1, 31, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
